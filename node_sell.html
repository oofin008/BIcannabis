<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">

  <title>Cannabis</title>

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="plugins/fontawesome-free/css/all.min.css">
  <!-- overlayScrollbars -->
  <link rel="stylesheet" href="plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="dist/css/adminlte.min.css">
  <!-- Google Font: Source Sans Pro -->
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">
</head>
<body class="hold-transition layout-top-nav">

  <!--LOADING STATE OVERLAY-->
  <div class="overlay-wrapper" id="loading_state" style="display: none;">
    <!--Loading state-->
    <div class="overlay">
      <i class="fa fa-refresh fa-spin"></i>
      <h3>Loading...</h3>
    </div>
    <!--Loading state-->
  </div>

<div class="wrapper">
  <!-- Navbar -->
  <nav class="main-header navbar navbar-expand navbar-dark ">
    <!-- Left navbar links -->
    <ul class="navbar-nav">
      <li class="nav-item d-none d-sm-inline-block">
        <a href="index.html" class="nav-link">หน้าแรก</a>
      </li>
      <li class="nav-item d-none d-sm-inline-block">
        <a href="node_import.html" class="nav-link">นำเข้ากัญชา</a>
      </li>
      <li class="nav-item d-none d-sm-inline-block">
        <a href="node_plant.html" class="nav-link">การผลิตปลูก</a>
      </li>
      <li class="nav-item d-none d-sm-inline-block">
        <a href="node_sell3.html" class="nav-link ">จำหน่ายพืช</a>
      </li>
      <li class="nav-item d-none d-sm-inline-block">
        <a href="node_convert.html" class="nav-link">การผลิตแปรรูป</a>
      </li>
      <li class="nav-item d-none d-sm-inline-block">
        <a href="node_sell_2.html" class="nav-link">จำหน่ายผลิตภัณฑ์</a>
      </li>
      <li class="nav-item d-none d-sm-inline-block">
        <a href="node_sell_index.html" class="nav-link bg-info">การจำหน่ายบำบัด</a>
      </li>
      
      <li class="nav-item d-none d-sm-inline-block">
        <a href="node_occupy.html" class="nav-link">การครอบครอง</a>
      </li>
      
    </ul>

  </nav>
  <!-- /.navbar -->

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper sidebar-dark-primary">
    <!-- Content Header (Page header) -->
    <div class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1 id="pageTitle" class="m-0 text-white">ข้อมูลการจำหน่ายบำบัด</h1>
          </div><!-- /.col -->
          <div class="col-sm-6">
            <div class="btn-group-lg float-right">
              <button style="width: 200px;" type="button" class="btn btn-tool dropdown-toggle" data-toggle="dropdown">
                <i class="fas fa-cannabis"></i>
                Sort select
              </button>
              <div class="dropdown-menu dropdown-menu-md-right" role="menu">
                <a href="?sortselected=SAS" class="dropdown-item">แผนปัจจุบัน</a>
                <a href="?sortselected=AUR" class="dropdown-item">แผนไทย</a>
                <a href="?sortselected=DEJA" class="dropdown-item">ผลิตภัณฑ์กัญชาน้ำมันเดชา</a>
              </div>
            </div>
          </div><!-- /.col -->
        </div><!-- /.row -->
      </div><!-- /.container-fluid -->
    </div>
    <!-- /.content-header -->

    <!-- Main content -->
    <section class="content">
      <div class="container-fluid">

        <!--ROW 0: รายงานจาก สปสช SECTION-->
        <div class="card bg-gradient-dark">
          <div class="card-header">
            <h3 class="card-title">รายงานจาก สปสช</h3>
            <div class="card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i></button>
            </div>
          </div><!--./end card header-->

          <div class="card-body">
            <div class="row">
              <!--Left row-->
              <div class="col-md-6">
                <div class="card bg-gradient-dark" >
                  <div class="card-header">
                    <h5 class="card-title">โรงพยาบาล 5 อันดับแรกที่มีการกระจายยามากที่สุด</h5>
                    <div class="card-tools">
                      <button id = "paChart_button" type="button" class="btn bg-olive margin">รายละเอียด</button>
                    </div>
                  </div><!--./end card header-->
        
                  <div class="card-body">
                    <div class="chart">
                      <!-- Sales Chart Canvas -->
                      <canvas id="paChart" style="height: 400px;"></canvas>
                    </div><!-- /.chart-responsive -->
                  </div><!-- ./card-body -->
                </div><!-- /.card -->
              </div>

              <!--Right row-->
              <div class="col-md-6">
                <div class="card bg-gradient-dark">
                  <div class="card-header" style="height: 60px;">
                    <h5 class="card-title">ปริมาณการใช้ยาตามตำรับ</h5>
                  </div>
                  <div class="card-body">
                    <div class="chart">
                      <div id="cannabisUsage_anychart" style="height: 400px; width: 100%; margin: 0; padding: 0;"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div><!--./end row-->
          </div><!--./end card-body -->
        </div><!--./ End ROW0 รายงานจาก สปสช-->

        <!--ROW 1: รายงานความปลอดภัย section-->
        <div class="card bg-gradient-dark">
          <div class="card-header">
            <h3 class="card-title">รายงานความปลอดภัย</h3>
            <div class="card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i></button>
            </div>
          </div>
          <!--ROW1: card body-->
          <div class="card-body">
            <!--row 2-->
            <div class="row">
              <div class="col-md-6">
                <!-- MAP & BOX PANE -->
                <div class="card bg-gradient-dark">
                  <div class="card-header">
                    <h3 class="card-title">Cannabis Usage</h3>

                    <div class="card-tools">
                      <button type="button" class="btn btn-tool" data-card-widget="collapse">
                        <i class="fas fa-minus"></i>
                      </button>

                    </div>
                  </div>
                  <div class="card-body p-0">
                    <div class="d-md-flex">
                      <div class="p-1 flex-fill" style="overflow: hidden">
                        <p class="text-center">
                          <strong>กุมภาพันธ์ - 2563</strong>
                        </p>
                        <!-- Map will be created here -->
                        <div class="chart">
                          <canvas id="cannabisUsageChart" style="height: 400px; overflow: hidden"></canvas>
                        </div>
                      </div>
                    </div><!-- /.d-md-flex -->
                  </div>
                  <!-- /.card-body -->
                </div>
                <!-- /. End Cannabis Usage card -->
              </div><!--End Left Col-->

              <div class="col-md-6">
                <div class="card bg-gradient-dark" id="sortChart1_card">
                  <div class="card-header">
                    <h3 class="card-title" id="sortChart1_title">จำนวนผู้ป่วยทั้งหมดแยกตามโรค</h3>
                    
                    <div class="card-tools">
                      <button type="button" class="btn btn-tool" data-card-widget="collapse">
                        <i class="fas fa-minus"></i>
                      </button>
                      
                    </div>
                  </div>
                  <!-- /.card-header -->
                  <div class="card-body p-0">
                    <div class="d-md-flex">
                      <div class="p-1 flex-fill" style="overflow: hidden">
                        <p class="text-center">
                          <strong  id="sortChart1_header">กุมภาพันธ์ - 2563</strong>
                        </p>
                        <div class="chart-responsive">
                          <canvas id="sortChart1" style="height: 400px; overflow: hidden"></canvas>
                          
                        </div>
                      </div>
                    </div><!-- /.d-md-flex -->
                  </div>
                  <!-- /.card-body -->
                  <div class="card-footer">
                    <div id="sortChart1_legend"></div>
                  </div>
                </div>
                <!-- /. End sortChart1 Usage card -->

                <div class="card bg-gradient-dark" id="sortChart5_card" >
                  <div class="card-header">
                    <h3 class="card-title" id="sortChart5_title">Chart5</h3>
                    <div class="card-tools">
                      <div class="btn-group">
                        <button type="button" class="btn btn-tool dropdown-toggle" data-toggle="dropdown">
                          <i class="fas fa-cannabis"></i>
                          ตำรับ
                        </button>
                        <div id="sortChart5_type_sel" class="dropdown-menu dropdown-menu-right" role="menu">
                          <a href= "#sortChart5_title" value="01" class="dropdown-item">ยาศุขไสยาศน์ อาจาโร เฮิร์บ </a>
                          <a href="#sortChart5_title" value="02" class="dropdown-item">น้ำมันกัญชา (ตำรับหมอเดชา) DTAM GANJA OIL (DEJA FORMULA) Usage</a>
                          <a href="#sortChart5_title" value="03" class="dropdown-item">ยาทำลายพระสุเมรุ อาจาโร เฮิร์บ</a>
                          <a href="#sortChart5_title" value="04" class="dropdown-item">ตำรับยาศุขไสยาศน์</a>
                        </div>
                      </div>
                      <div class="btn-group">
                        <button type="button" class="btn btn-tool dropdown-toggle" data-toggle="dropdown">
                          <i class="fas fa-calendar-alt"></i>
                          Time Frame select
                        </button>
                        <div class="dropdown-menu dropdown-menu-right" role="menu">
                          <a href="#" class="dropdown-item">Jan/2020</a>
                          <a href="#" class="dropdown-item">Dec/2019</a>
                          <a href="#" class="dropdown-item">Nov/2019</a>
                          <a class="dropdown-divider"></a>
                          <a href="#" class="dropdown-item">Oct/2019</a>
                        </div>
                      </div>
                      <button type="button" class="btn btn-tool" data-card-widget="collapse">
                        <i class="fas fa-minus"></i>
                      </button>
                    </div>
                  </div>
                  <!-- /.card-header -->
                  <div class="card-body p-0">
                    <div class="d-md-flex">
                      <div class="p-1 flex-fill" style="overflow: hidden">
                        <p class="text-center">
                          <strong>กุมภาพันธ์ - 2563</strong>
                        </p>
                        <!-- Map will be created here -->
                        <div class="chart">
                          <canvas id="sortChart5" style="height: 400px; overflow: hidden"></canvas>
                        </div>
                      </div>
                    </div><!-- /.d-md-flex -->
                  </div>
                  <!-- /.card-body -->
                </div>
                <!-- /. End sortChart5 Usage card -->

              </div><!--End Right Col-->
            </div>
          </div>
        </div><!--End ROW1: Usage section-->

        <!--Row2 :จำนวนผู้ป่วย-->
        <div class="card bg-gradient-dark">
          <div class="card-header">
            <h3 class="card-title">จำนวนผู้ป่วย</h3>
            <div class="card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i></button>
            </div>
          </div>

          <div class="card-body">
            <div class="row">
              <!--LEFT col-->
              <div class="col-md-6">
                <div class="card bg-gradient-dark">
                  <div class="card-header">
                    <h3 class="card-title">การจ่ายยาให้ผู้ป่วยแบ่งตามเพศ</h3>
                    <div class="card-tools">
                      <div class="btn-group">
                        <button type="button" class="btn btn-tool dropdown-toggle" data-toggle="dropdown">
                          <i class="fas fa-calendar-alt"></i>
                          Time Frame select
                        </button>
                        <div class="dropdown-menu dropdown-menu-right" role="menu">
                          <a href="#" class="dropdown-item">Jan/2020</a>
                          <a href="#" class="dropdown-item">Dec/2019</a>
                          <a href="#" class="dropdown-item">Nov/2019</a>
                          <a class="dropdown-divider"></a>
                          <a href="#" class="dropdown-item">Oct/2019</a>
                        </div>
                      </div>
                      <button type="button" class="btn btn-tool" data-card-widget="collapse">
                        <i class="fas fa-minus"></i>
                      </button>
                    </div>
                  </div>
                  <!-- /.card-header -->
                  <div class="card-body p-0">
                    <div class="d-md-flex">
                      <div class="p-1 flex-fill" style="overflow: hidden">
                        <p class="text-center">
                          <strong>ปี 2562 - 2563 (ราย)</strong>
                        </p>
                        <!-- Map will be created here -->
                        <div class="chart">
                          <canvas id="medDistribute" style="height: 400px; overflow: hidden"></canvas>
                        </div>
                      </div>
                    </div><!-- /.d-md-flex -->
                  </div>
                  <!-- /.card-body -->
                </div>
                <!-- /.End paChart card -->
              </div>
              <!--RIGHT col-->
              <div class="col-md-6">
                <div class="card bg-gradient-dark">
                  <div class="card-header">
                    <h3 class="card-title">จำนวนผู้ป่วยในแต่ละช่วงอายุ</h3>
    
                    <div class="card-tools">
                      <div class="btn-group">
                        <button type="button" class="btn btn-tool dropdown-toggle" data-toggle="dropdown">
                          <i class="fas fa-calendar-alt"></i>
                          Time Frame select
                        </button>
                        <div class="dropdown-menu dropdown-menu-right" role="menu">
                          <a href="#" class="dropdown-item">Jan/2020</a>
                          <a href="#" class="dropdown-item">Dec/2019</a>
                          <a href="#" class="dropdown-item">Nov/2019</a>
                          <a class="dropdown-divider"></a>
                          <a href="#" class="dropdown-item">Oct/2019</a>
                        </div>
                      </div>
                      <button type="button" class="btn btn-tool" data-card-widget="collapse">
                        <i class="fas fa-minus"></i>
                      </button>
                    </div>
                  </div>
                  <!-- /.card-header -->
                  <div class="card-body">
                    <div class="row">
                      <div class="chart">
                        <canvas id="barChart"style="height: 400px; overflow: hidden"></canvas>
                      </div>
                    </div>
                    <!-- /.row -->
                  </div>
                  <!-- /.card-body -->
                </div>
              </div>
            </div>
          </div>
        </div><!--End Row2: จำนวนผู้ป่วย-->
        
        <!--Row 3: ข้อมูลการรักษา-->
        <div class="card bg-gradient-dark">
          <div class="card-header">
            <h3 class="card-title">ข้อมูลการรักษา</h3>
            <div class="card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fa fa-minus"></i></button>
            </div>
          </div>
          <div class="card-body">
            <div class="row">
              <!-- Left col -->
              <div class="col-md-6" id="leftCol">
                <div class="card bg-gradient-dark" id="sortChart2_card">
                  <div class="card-header">
                    <h3 class="card-title" id="sortChart2_title">Chart2</h3>

                    <div class="card-tools">
                      <div class="btn-group">
                        <button type="button" class="btn btn-tool dropdown-toggle" data-toggle="dropdown">
                          <i class="fas fa-calendar-alt"></i>
                          Time Frame select
                        </button>
                        <div class="dropdown-menu dropdown-menu-right" role="menu">
                          <a href="#" class="dropdown-item">Jan/2020</a>
                          <a href="#" class="dropdown-item">Dec/2019</a>
                          <a href="#" class="dropdown-item">Nov/2019</a>
                          <a class="dropdown-divider"></a>
                          <a href="#" class="dropdown-item">Oct/2019</a>
                        </div>
                      </div>
                      <button type="button" class="btn btn-tool" data-card-widget="collapse">
                        <i class="fas fa-minus"></i>
                      </button>
                    </div>
                  </div>
                  <!-- /.card-header -->
                  <div class="card-body p-0">
                    <div class="d-md-flex">
                      <div class="p-1 flex-fill" style="overflow: hidden">
                        <p class="text-center">
                          <strong>กุมภาพันธ์ - 2563</strong>
                        </p>
                        <div class="chart">
                          <canvas id="sortChart2" style="height: 400px; overflow: hidden"></canvas>
                        </div>
                      </div>
                    </div><!-- /.d-md-flex -->
                  </div>
                  <!-- /.card-body -->
                </div>
                <!-- /. End sortChart2 Usage card -->

                <div class="card bg-gradient-dark" id="sortChart3_card">
                  <div class="card-header">
                    <h3 class="card-title" id="sortChart3_title">Chart3</h3>

                    <div class="card-tools">
                      <div class="btn-group">
                        <button type="button" class="btn btn-tool dropdown-toggle" data-toggle="dropdown">
                          <i class="fas fa-calendar-alt"></i>
                          Time Frame select
                        </button>
                        <div class="dropdown-menu dropdown-menu-right" role="menu">
                          <a href="#" class="dropdown-item">Jan/2020</a>
                          <a href="#" class="dropdown-item">Dec/2019</a>
                          <a href="#" class="dropdown-item">Nov/2019</a>
                          <a class="dropdown-divider"></a>
                          <a href="#" class="dropdown-item">Oct/2019</a>
                        </div>
                      </div>
                      <button type="button" class="btn btn-tool" data-card-widget="collapse">
                        <i class="fas fa-minus"></i>
                      </button>
                    </div>
                  </div>
                  <!-- /.card-header -->
                  <div class="card-body p-0">
                    <div class="d-md-flex">
                      <div class="p-1 flex-fill" style="overflow: hidden">
                        <p class="text-center">
                          <strong>กุมภาพันธ์ - 2563</strong>
                        </p>
                        <!-- Map will be created here -->
                        <div class="chart">
                          <canvas id="sortChart3" style="height: 400px; overflow: hidden"></canvas>
                        </div>
                      </div>
                    </div><!-- /.d-md-flex -->
                  </div>
                  <!-- /.card-body -->
                </div>
                <!-- /. End sortChart3 Usage card -->

              </div>
              <!-- /. End Left col -->

              <!--Right Column-->
              <div class="col-md-6" id="rightCol">
                <div class="card bg-gradient-dark">
                  <div class="card-header">
                    <h3 class="card-title">จำนวนผู้ป่วยแบ่งตามโรค</h3>
                    <div class="card-tools">
                      <div class="btn-group">
                        <button type="button" class="btn btn-tool dropdown-toggle" data-toggle="dropdown">
                          <i class="fas fa-calendar-alt"></i>
                          Time Frame select
                        </button>
                        <div class="dropdown-menu dropdown-menu-right" role="menu">
                          <a href="#" class="dropdown-item">Jan/2020</a>
                          <a href="#" class="dropdown-item">Dec/2019</a>
                          <a href="#" class="dropdown-item">Nov/2019</a>
                          <a class="dropdown-divider"></a>
                          <a href="#" class="dropdown-item">Oct/2019</a>
                        </div>
                      </div>
                      <button type="button" class="btn btn-tool" data-card-widget="collapse">
                        <i class="fas fa-minus"></i>
                      </button>
                    </div>
                  </div>
                  <!-- /.card-header -->
                  <div class="card-body">
                    <div class="row">
                      <div class="col-12">
                        <div class="chart-responsive">
                          <canvas id="donutChart" style="height: 400px; overflow: hidden"></canvas>
                        </div>
                        <!-- ./chart-responsive -->
                      </div>
                      <!-- /.col -->
                    </div>
                    <!-- /.row -->
                  </div>
                  <!-- /.card-body -->
                </div>
                <!-- /.card -->

                <div class="card bg-gradient-dark" id="sortChart4_card">
                  <div class="card-header">
                    <h3 class="card-title" id="sortChart4_title">Chart4</h3>
                    <div class="card-tools">
                      <div class="btn-group">
                        <button type="button" class="btn btn-tool dropdown-toggle" data-toggle="dropdown">
                          <i class="fas fa-calendar-alt"></i>
                          Time Frame select
                        </button>
                        <div class="dropdown-menu dropdown-menu-right" role="menu">
                          <a href="#" class="dropdown-item">Jan/2020</a>
                          <a href="#" class="dropdown-item">Dec/2019</a>
                          <a href="#" class="dropdown-item">Nov/2019</a>
                          <a class="dropdown-divider"></a>
                          <a href="#" class="dropdown-item">Oct/2019</a>
                        </div>
                      </div>
                      <button type="button" class="btn btn-tool" data-card-widget="collapse">
                        <i class="fas fa-minus"></i>
                      </button>
                    </div>
                  </div>
                  <!-- /.card-header -->
                  <div class="card-body p-0">
                    <div class="d-md-flex">
                      <div class="p-1 flex-fill" style="overflow: hidden">
                        <p class="text-center">
                          <strong>กุมภาพันธ์ - 2563</strong>
                        </p>
                        <div class="chart">
                          <canvas id="sortChart4" style="height: 400px; overflow: hidden"></canvas>
                        </div>
                      </div>
                    </div><!-- /.d-md-flex -->
                  </div>
                  <!-- /.card-body -->
                </div>
                <!-- /. End sortChart4 Usage card -->
              </div>
              <!-- /.col -->
            </div>
          </div>
        </div>
        <!-- /.row -->
      </div><!--/. container-fluid -->
    </section>
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->

  <!-- Main Footer -->
  <footer class="main-footer">
    ข้อมูลอ้างอิงจากไฟล์ รายงานกัญชา20200221_V2.xlsx และ รายงานความปลอดภัย(ข้อมูลกัญชา_AUR_19-02-2020, ข้อมูลกัญชา_SAS_19-02-2020) และ สูตรPB_EQ5D5L-final-for-web, Copy-of-Thai5LCalculator_17.06.2559
    <div class="float-right d-none d-sm-inline-block">
      
    </div>
  </footer>
</div>
<!-- ./wrapper -->

<!-- REQUIRED SCRIPTS -->
<!-- jQuery -->
<script src="plugins/jquery/jquery.min.js"></script>
<!-- Bootstrap -->
<script src="plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- overlayScrollbars -->
<script src="plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>
<!-- AdminLTE App -->
<script src="dist/js/adminlte.js"></script>

<!--AnyChart for Treemap chart-->
<script src="https://cdn.anychart.com/releases/v8/js/anychart-core.min.js"></script>
<script src="https://cdn.anychart.com/releases/v8/js/anychart-treemap.min.js"></script>
<!-- PAGE PLUGINS -->
<!-- jQuery Mapael -->
<script src="plugins/jquery-mousewheel/jquery.mousewheel.js"></script>
<script src="plugins/raphael/raphael.min.js"></script>
<script src="plugins/jquery-mapael/jquery.mapael.min.js"></script>
<script src="plugins/jquery-mapael/maps/usa_states.min.js"></script>
<!-- ChartJS -->
<script src="plugins/chart.js/Chart.min.js"></script>

<!-- PAGE SCRIPTS -->
<script src="https://d3js.org/d3.v5.min.js"></script>



<!--Script Tag Begin-->
<script>
  var node_sell_data = new Array;
  var hospital_sell_sum = {},hospital_result;
  var top_5_hospital;

  $('#loading_state').show();
  $.getJSON('./dist/js/jsondata/node_sell_data.json', function(data){
    node_sell_data = data.Sheet1;
    //console.log('node sell data ===>>>', node_sell_data);

    //Sum PAY value for duplicate LICENSE_PLACE name
    for(var i=0,c; c=node_sell_data[i]; i++){
      if(undefined === hospital_sell_sum[c['LICENSE_PLACE']]){
        hospital_sell_sum[c['LICENSE_PLACE']] = c;
        hospital_sell_sum[c['LICENSE_PLACE']]['PAY'] = parseInt(hospital_sell_sum[c['LICENSE_PLACE']]['PAY']);
      }
      else{
        hospital_sell_sum[c['LICENSE_PLACE']]['PAY'] += parseInt(c['PAY']);
      }
    }
    hospital_result = Object.keys(hospital_sell_sum).map(function(val){ return hospital_sell_sum[val]});

    //END Sum Duplicate

    //Find top 5 hospital
    top_5_hospital = hospital_result.sort((a,b) => b["PAY"] - a["PAY"]);

    //Sort SAS, AUR, DEJA
    var top_5_sas = new Array;
    var top_5_aur = new Array;
    var top_5_deja= new Array;
    for(var i=0; i<top_5_hospital.length; i++){
      if(['SAS1', 'SAS2', 'SAS3','SAS4'].includes(top_5_hospital[i]['REGISTER_CODE'])){
        top_5_sas.push(top_5_hospital[i]);
      }
      if(['TP2','TP6','TP9','TP10','TP11','TP14','TP15'].includes(top_5_hospital[i]['REGISTER_CODE'])){
        top_5_aur.push(top_5_hospital[i]);
      }
      if(['RES1'].includes(top_5_hospital[i]['REGISTER_CODE'])){
        top_5_deja.push(top_5_hospital[i]);
      }
    }
    console.log('TOP5 SAS: ');
    console.log(top_5_sas.slice(0,5));
    console.log('TOP5 AUR: ');
    console.log(top_5_aur.slice(0,5));
    console.log('TOP5 DEJA: ');
    console.log(top_5_deja.slice(0,5));
    //END sorting TOP5

    $('#loading_state').hide();
  });
  var getReq = getUrlParameter("sortselected");
  if(getReq === undefined){
    getReq = "SAS";
    console.log(getReq);
  }

  var pageTitle = document.getElementById('pageTitle');
  if(getReq == "SAS"){
    pageTitle.innerText += " แผนปัจจุบัน";
  }else if(getReq=="AUR"){
    pageTitle.innerText += " แผนไทย";
  }else if(getReq=="DEJA"){
    pageTitle.innerText += " ผลิตภัณฑ์กัญชาน้ำมันเดชา"
  }

  //------------
  //--Tree Map--
  //------------
  anychart.onDocumentReady(function(){
    var cannabisUsage_anychart_data= [
      {name: "ภาพรวม", children: [
        {name: "แผนไทย", children: [
          {name: "ยาศุขไสยาศน์", value: 22970},
          {name: "ยาทำลายพระสุเมรุ", value: 22740},
          {name: "ยาไฟอาวุธ", value: 17100},
          {name: "ยาอัมฤตย์โอสถ", value: 1650},
          {name: "ยาอไกยสาลี", value: 4230},
          {name: "ยาแก้ลมแก้เส้น", value: 11250},
          {name: "ยาทาริดสีดวงทวารหนักและโรคผิวหนัง", value: 8310},
        ]},
        {name: "แผนปัจจุบัน", children: [
          {name: "GPO THC", value: 7796},
          {name: "GPO THC:CBD(1:1)", value: 2599},
          {name: "GPO CBD", value: 282},
          {name: "น้ำมันกัญชาหยอดใต้ลิ้น", value: 24090}
        ]},
        {name: "ผลิตภัณฑ์กัญชาน้ำมันเดชา", children: [
          {name: "น้ำมันกัญชาตำรับหมอเดชา", value: 48150},
        ]}
      ]}
    ];

    //Create Data tree
    var treeData = anychart.data.tree(cannabisUsage_anychart_data, "as-tree");
    //Create treemap chart visualizing the data tree
    var cannabisUsage_anychart_chart =  anychart.treeMap(treeData);
    //Add a title 
    cannabisUsage_anychart_chart.labels().useHtml(true);
    cannabisUsage_anychart_chart.labels().format(
      `<span style='font-weight:bold' >{%name}</span><br>{%value} units`
    );
    cannabisUsage_anychart_chart.labels().fontSize(20);
    cannabisUsage_anychart_chart.container("cannabisUsage_anychart");
    cannabisUsage_anychart_chart.draw();
  });//End AnyChart ready function

  if(getReq == "SAS"){

    var patientChartData = {
      labels  : ['โรงพยาบาล พุทธชินราช พิษณุโลก','โรงพยาบาล สวรรค์ประชารักษ์','โรงพยาบาล ขอนแก่น','โรงพยาบาล พระนั่งเกล้า','โรงพยาบาล สระบุรี'],
      datasets: [
        
        {
          label               : 'จำนวนจ่าย',
          backgroundColor     : '#f0ad4e',
          data                : [340,257,220,138,108]
        }
      ]
    }//End top5 chart

    var cannabisUsageChartData = {
      labels  : ['GPO THC','น้ำมันกัญชาหยอดใต้ลิ้น','น้ำมันกัญชา LOVE HEMP','GPO THC:CBD(1:1)','ยาน้ำมันกัญชาหยอดใต้ลิ้น สูตร THC 1.7%W/V','GPO CBD'],
      datasets: [
        {
          type                : 'bar',
          label               : 'Total Usage',
          yAxesID: 'B',
          backgroundColor     : '#03fcf4',
          fill                : false,
          data                : [169,119,34,8,2,2]
        }
      ]
    }//End Cannabis Usage Data

    var sortChart1_title = document.getElementById("sortChart1_title");
    sortChart1_title.innerText = "จำนวนผู้ป่วยทั้งหมดแยกตามโรค";
    var sortChart1Data = {
      labels  : ['แผนปัจจุบัน','แผนไทย','น้ำมันเดชา'],
      datasets: [
        {
          label               : ['แผนปัจจุบัน: ผู้ป่วยที่ดูแลแบบประคับประคอง/ระยะสุดท้ายเพื่อใช้ในการบรรเทาอาการปวด',
          'แผนปัจจุบัน: ผู้ป่วยมะเร็ง (C00-97) เพื่อใช้บรรเทาอาการปวด',
          'แผนปัจจุบัน: ภาวะกล้ามเนื้อหดเกร็งในผู้ป่วยโรคปลอกประสาทเสื่อมแข็ง (G35,629)',
          'แผนปัจจุบัน: ภาวะคลื่นไส้อาเจียนจากเคมีบำบัด',
          'แผนปัจจุบัน: ภาวะปวดประสาท(M792,G60-64)ที่ดื้อต่อการรักษา',
          'แผนปัจจุบัน: โรคพาร์กินสัน  (G20)',
          'แผนปัจจุบัน: โรคลมชัก (G40-41) ที่รักษายากหรือดื้อต่อการรักษา',
          'แผนปัจจุบัน: โรคอัลไซเมอร์  (G309)',
          'แผนปัจจุบัน: โรค/อาการอื่นๆ',
          'แผนไทย: - DISORDERS OF INITIATING AND MAINTAINING SLEEP [INSOMNIAS]',
          'แผนไทย: - ชา',
          'แผนไทย: นอนไม่หลับ',
          'แผนไทย: เบื่ออาหาร',
          'แผนไทย: ปวดขา หรือ ปวดเข่า หรือ ปวดเท้า',
          'แผนไทย: ลมปลายปัตฆาตแขน',
          'แผนไทย: ลมปลายปัตฆาตแขนขา  ไม่ระบุรายละเอียด',
          'แผนไทย: ลมปลายปัตฆาตสัญญาณ 1 หลัง',
          'แผนไทย: ไม่ระบุ',
          'น้ำมันเดชา: ALZHEIMER DISEASE, UNSPECIFIED',
          'น้ำมันเดชา: BLADDER, UNSPECIFIED',
          'น้ำมันเดชา: BRAIN, UNSPECIFIED',
          'น้ำมันเดชา: BREAST, UNSPECIFIED',
          'น้ำมันเดชา: BRONCHUS OR LUNG, UNSPECIFIED',
          'น้ำมันเดชา: COLON, UNSPECIFIED',
          'น้ำมันเดชา: CORPUS UTERI, UNSPECIFIED',
          'น้ำมันเดชา: DISORDER OF TRIGEMINAL NERVE, UNSPECIFIED',
          'น้ำมันเดชา: DORSALGIA, UNSPECIFIED',
          'น้ำมันเดชา: EPILEPSY, UNSPECIFIED',
          'น้ำมันเดชา: FLOOR OF MOUTH, UNSPECIFIED',
          'น้ำมันเดชา: GOUT, UNSPECIFIED',
          'น้ำมันเดชา: INTRAHEPATIC BILE DUCT CARCINOMA',
          'น้ำมันเดชา: LARYNX, UNSPECIFIED',
          'น้ำมันเดชา: LIVER, UNSPECIFIED',
          'น้ำมันเดชา: LYMPH NODE, UNSPECIFIED',
          'น้ำมันเดชา: MALIGNANT NEOPLASM ',
          'น้ำมันเดชา: MIGRAINE, UNSPECIFIED',
          'น้ำมันเดชา: NASOPHARYNX, UNSPECIFIED',
          'น้ำมันเดชา: NONORGANIC INSOMNIA',
          'น้ำมันเดชา: OESOPHAGUS, UNSPECIFIED',
          'น้ำมันเดชา: OTHER PERIPHERAL VERTIGO',
          'น้ำมันเดชา: PANCREAS, UNSPECIFIED',
          'น้ำมันเดชา: PANIC DISORDER [EPISODIC PAROXYSMAL ANXIETY]',
          'น้ำมันเดชา: PARKINSON DISEASE',
          'น้ำมันเดชา: SEQUELAE OF STROKE, NOT SPECIFIED AS HAEMORRHAGE OR INFARCTION',
          'น้ำมันเดชา: STOMACH, UNSPECIFIED',
          'น้ำมันเดชา: SYSTEMIC LUPUS ERYTHEMATOSUS, UNSPECIFIED',
          'น้ำมันเดชา: TONSIL, UNSPECIFIED',
          'น้ำมันเดชา: UNSPECIFIED CHRONIC BRONCHITIS',
          'น้ำมันเดชา: ZOSTER WITHOUT COMPLICATION',
          'น้ำมันเดชา: กษัยลิ้นกระบือ',
          'น้ำมันเดชา: ความผิดปกติของกล้ามเนื้อ  กระดูก  และข้อ  ไม่ระบุรายละเอียด',
          'น้ำมันเดชา: ชา',
          'น้ำมันเดชา: นอนไม่หลับ',
          'น้ำมันเดชา: ปวดตามร่างกาย',
          'น้ำมันเดชา: เรื้อนมูลนก',
          'น้ำมันเดชา: โรคและอาการของศีรษะ  สมอง  และระบบประสาท  ไม่ระบุรายละเอียด',
          'น้ำมันเดชา: ลมปะกัง หรือ ลมตะกัง',
          'น้ำมันเดชา: สะเก็ดเงิน',
          'น้ำมันเดชา: สันนิบาตข้อมือตก หรือ สันนิบาตข้อมือ',
          'น้ำมันเดชา: สันนิบาตลูกนก',
          'น้ำมันเดชา: ไม่ระบุ',
          
          ],
          backgroundColor     : ['#f0ad4e','#f0ad4e','#f0ad4e','#f0ad4e','#f0ad4e','#f0ad4e','#f0ad4e','#f0ad4e','#f0ad4e',
          '#5bc0de','#5bc0de','#5bc0de','#5bc0de','#5bc0de','#5bc0de','#5bc0de','#5bc0de','#5bc0de',
          '#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7',
          '#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7',
          '#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7',
          '#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7',
          '#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7','#BDC3C7',
        ],
          data                : [
            145,68,8,8,55,34,12,1,35,
            2,1,47,24,1,1,6,1,244,
            3,1,1,5,6,4,1,1,2,3,1,1,1,2,3,2,4,5,2,3,1,1,1,8,1,1,1,1,1,1,1,2,1,49,2,1,6,3,1,5,1,1,886
          ]
        },
        {
          label               : ['แผนปัจจุบัน','แผนไทย','น้ำมันเดชา'],
          backgroundColor     : ['#f0ad4e','#5bc0de','#BDC3C7',],
          data                : [364,327,1025]
        },
      ]
    }//End chart1 Usage Data

    var sortChart2_title = document.getElementById("sortChart2_title");
    sortChart2_title.innerText = "ข้อมูลการรักษา";
    var sortChart2Data = {
      labels  : ['GPO THC', 'GPO THC:CBD', 'GPO CBD', 'น้ำมันกัญชา'],
      datasets: [
        {
          type                : 'bar',
          label               : 'pariative care',
          yAxesID: 'B',
          backgroundColor     : '#03fcf4',
          fill                : false,
          data                : [50,4,0,68]
        },
        {
          type                : 'bar',
          label               : 'ปวดจากมะเร็ง',
          yAxesID: 'B',
          backgroundColor     : '#00ff00',
          fill                : false,
          data                : [47,1,0,7]
        },
        {
          type                : 'bar',
          label               : 'ปวดประสาท',
          yAxesID: 'B',
          backgroundColor     : '#ff6600',
          fill                : false,
          data                : [27,1,0,15]
        },
        {
          type                : 'bar',
          label               : 'พาร์กินสัน',
          yAxesID: 'B',
          backgroundColor     : '#cc00cc',
          fill                : false,
          data                : [2,1,0,2]
        },
        {
          type                : 'bar',
          label               : 'ชัก',
          yAxesID: 'B',
          backgroundColor     : '#00cc99',
          fill                : false,
          data                : [0,0,2,0]
        },
        {
          type                : 'bar',
          label               : 'กล้ามเนื้อหดเกร็ง',
          yAxesID: 'B',
          backgroundColor     : '#9933ff',
          fill                : false,
          data                : [0,5,1,0]
        },

      ]
    }//End chart2 Usage Data

    var sortChart3_title = document.getElementById("sortChart3_title");
    sortChart3_title.innerText = "ข้อมูลอาการไม่พึงประสงค์";
    var sortChart3Data = {
      labels  : ['GPO THC', 'GPO THC:CBD', 'GPO CBD', 'น้ำมันกัญชา'],
      datasets: [
      {
          type                : 'bar',
          label               : 'เสียชีวิต',
          yAxesID: 'B',
          backgroundColor     : '#03fcf4',
          fill                : false,
          data                : [0,0,0,11]
        },
        {
          type                : 'bar',
          label               : 'หูแว่ว',
          yAxesID: 'B',
          backgroundColor     : '#00ff00',
          fill                : false,
          data                : [1,0,0,0]
        },
        {
          type                : 'bar',
          label               : 'ไตวาย',
          yAxesID: 'B',
          backgroundColor     : '#ff6600',
          fill                : false,
          data                : [0,0,0,1]
        },
        {
          type                : 'bar',
          label               : 'ปากแห้ง คอแห้ง',
          yAxesID: 'B',
          backgroundColor     : '#cc00cc',
          fill                : false,
          data                : [2,1,0,2]
        },
        {
          type                : 'bar',
          label               : 'เวียนศีรษะ',
          yAxesID: 'B',
          backgroundColor     : '#00cc99',
          fill                : false,
          data                : [7,2,0,6]
        },
        {
          type                : 'bar',
          label               : 'นอนไม่หลับ',
          yAxesID: 'B',
          backgroundColor     : '#9933ff',
          fill                : false,
          data                : [6,0,0,1]
        },
        {
          type                : 'bar',
          label               : 'ชัก',
          yAxesID: 'B',
          backgroundColor     : '#ffff66',
          fill                : false,
          data                : [0,0,2,0]
        },
      ]
    }//End chart3 Usage Data

    //BI supply chain edited 03-Apr-2020
    var sortChart4_title = document.getElementById("sortChart4_title");
    sortChart4_title.innerText = "ข้อมูลผลการประเมินหลังการใช้ (กรณีมีอาการไม่พึงประสงค์)";
    var sortChart4Data = {
      labels  : ['หายเป็นปกติโดยไม่มีร่องรอยเดิม', 'หายโดยยังมีร่องรอยเดิม', 'อาการดีขึ้นแต่ยังไม่หาย', 'ยังมีอาการอยู่ / ยังไม่ดีขึ้น'],
      datasets: [
      {
          type                : 'bar',
          label               : 'แผนปัจจุบัน',
          yAxesID: 'B',
          backgroundColor     : '#f0ad4e',
          fill                : false,
          data                : [1283,94,3268,4623]
        },
        {
          type                : 'bar',
          label               : 'แผนไทย',
          yAxesID: 'B',
          backgroundColor     : '#5bc0de',
          fill                : false,
          data                : [1265,5,207,134]
        },
        {
          type                : 'bar',
          label               : 'น้ำมันเดชา',
          yAxesID: 'B',
          backgroundColor     : '#f7f7f7',
          fill                : false,
          data                : [4137,110,1848,1250]
        },
      ]
    }//End chart4 Usage Data
    
    document.getElementById("sortChart5_card").style.display = "none";
  }//END 

  else if(getReq == "AUR"){
    var patientChartData = {
      labels  : ['โรงพยาบาล สมเด็จพระยุพราชเด่นชัย', 'โรงพยาบาลพระอาจารย์ฝั้น อาจาโร', 'โรงพระยาบาล ลำปาง', 'โรงพยาบาล เสาไห้เฉลิมพระเกียรติ ๘๐ พรรษา', 'โรงพยาบาลมหาราชนครราชสีมา',],
      datasets: [
        {
          label               : 'จำนวนจ่าย',
          backgroundColor     : '#5bc0de',
          data                : [1833,1805,1771,1049,841]
        }
      ]
    }//End patient chart Data

    var cannabisUsageChartData = {
      labels  : ['GANJA OIL (DEJA FORMULA)','นาศุขไสยาศน์ อาจาโร เฮิร์บ','ยาทำลายพระสุเมรุ อาจาโร เฮิร์บ','ตำรับยาศุขไสยาศน์'],
      datasets: [
        {
          type                : 'bar',
          label               : 'Total Usage',
          yAxesID: 'B',
          backgroundColor     : '#03fcf4',
          fill                : false,
          data                : [1345, 346, 114, 2]
        }
      ]
    }//End Cannabis Usage Data

    var sortChart5_title = document.getElementById("sortChart5_title");
    sortChart5_title.innerText = "ยาศุขไสยาศน์ อาจาโร เฮิร์บ Usage";
    var sortChart5Data = {
      labels  : ['นอนไม่หลับ','เบื่ออาหาร','ลมปลายปัตฆาตแขน','G AND MAINTAINING SLEEP [INSOMNIAS]','ลมปลายปัตฆาตสัญญาณ 1 หลัง'],
      datasets: [
        {
          type                : 'bar',
          label               : 'Total Usage',
          yAxesID: 'B',
          backgroundColor     : '#03fcf4',
          fill                : false,
          data                : [73,37,2,1,1]
        }
      ]
    }//End chart5 Usage Data

    var sortChart2_title = document.getElementById("sortChart2_title");
    sortChart2_title.innerText = "ข้อมูลการรักษา";
    var sortChart2Data = {
      labels  : ['ยาศุขไสยาศน์', 'ยาทำลายพระสุเมรุ','ยาแก้ลมแก้เส้น'],
      datasets: [
        {
          type                : 'bar',
          label               : 'นอนไม่หลับ',
          yAxesID: 'B',
          backgroundColor     : '#03fcf4',
          fill                : false,
          data                : [120,0,1]
        },
        {
          type                : 'bar',
          label               : 'เบื่ออาหาร',
          yAxesID: 'B',
          backgroundColor     : '#00ff00',
          fill                : false,
          data                : [41,0,0]
        },
        {
          type                : 'bar',
          label               : 'ปวดกล้ามเนื้อ',
          yAxesID: 'B',
          backgroundColor     : '#ff6600',
          fill                : false,
          data                : [2,10,10]
        },
        {
          type                : 'bar',
          label               : 'ชา',
          yAxesID: 'B',
          backgroundColor     : '#cc00cc',
          fill                : false,
          data                : [0,1,2]
        },
        {
          type                : 'bar',
          label               : 'อัมพฤกษ์',
          yAxesID: 'B',
          backgroundColor     : '#9933ff',
          fill                : false,
          data                : [0,11,1]
        },

      ]
    }//End chart2 Usage Data

    var sortChart3_title = document.getElementById("sortChart3_title");
    sortChart3_title.innerText = "ข้อมูลอาการไม่พึงประสงค์";
    var sortChart3Data = {
      labels  : ['ยาศุขไสยาศน์','ยาทำลายพระสุเมรุ'],
      datasets: [
      {
          type                : 'bar',
          label               : 'เวียนศรีษะ วิงเวียน ปวดหัว',
          yAxesID: 'B',
          backgroundColor     : '#03fcf4',
          fill                : false,
          data                : [8,1]
        },
        {
          type                : 'bar',
          label               : 'แสบร้อนกลางอก',
          yAxesID: 'B',
          backgroundColor     : '#00ff00',
          fill                : false,
          data                : [4]
        },
        {
          type                : 'bar',
          label               : 'คลื่นไส้อาเจียน',
          yAxesID: 'B',
          backgroundColor     : '#ff6600',
          fill                : false,
          data                : [5]
        },
        {
          type                : 'bar',
          label               : 'ปากแห้ง คอแห้ง',
          yAxesID: 'B',
          backgroundColor     : '#cc00cc',
          fill                : false,
          data                : [3]
        },
        {
          type                : 'bar',
          label               : 'กระเพาะอักเสบ',
          yAxesID: 'B',
          backgroundColor     : '#00cc99',
          fill                : false,
          data                : [2]
        },
        {
          type                : 'bar',
          label               : 'นอนไม่หลับ',
          yAxesID: 'B',
          backgroundColor     : '#9933ff',
          fill                : false,
          data                : [2]
        },
      ]
    }//End chart3 Usage Data

    var sortChart4_title = document.getElementById("sortChart4_title");
    sortChart4_title.innerText = "ข้อมูลผลการประเมินหลังการใช้";
    var sortChart4Data = {
      labels  : ['ยาศุขไสยาศน์','ยาทำลายพระสุเมรุ','ยาแก้ลมแก้เส้น'],
      datasets: [
      {
          type                : 'bar',
          label               : 'หายจากโรคที่เป็นอยู่',
          yAxesID: 'B',
          backgroundColor     : '#cc00cc',
          fill                : false,
          data                : [2,0,0]
        },
        {
          type                : 'bar',
          label               : 'อาการดีขึ้น',
          yAxesID: 'B',
          backgroundColor     : '#00cc99',
          fill                : false,
          data                : [55,19,0]
        },
        {
          type                : 'bar',
          label               : 'อาการไม่เปลี่ยนแปลง',
          yAxesID: 'B',
          backgroundColor     : '#9933ff',
          fill                : false,
          data                : [9,4,0]
        },
        {
          type                : 'bar',
          label               : 'อาการแย่ลง',
          yAxesID: 'B',
          backgroundColor     : '#ffff66',
          fill                : false,
          data                : [1,0,0]
        },
        {
          type                : 'bar',
          label               : 'ไม่ระบุ',
          yAxesID: 'B',
          backgroundColor     : '#666699',
          fill                : false,
          data                : [177,50,23]
        },
      ]
    }//End chart4 Usage Data

    document.getElementById('sortChart1_card').style.display = "none";

  }
  //DEJA check
  else if(getReq=="DEJA"){
    var patientChartData = {
      labels  : ['โรงพยาบาลการแพทย์แผนไทยและการแพทย์ผสมผสาน','โรงพยาบาล ศรีประจันต์','โรงพยาบาล ดอนตูม','โรงพยาบาลป่าบอน','โรงพยาบาลหนองฉาง'],
      datasets: [
        
        {
          label               : 'จำนวนจ่าย',
          backgroundColor     : '#f7f7f7',
          data                : [29239,4341,3629,1733,1356]
        }
      ]
    };

    var cannabisUsageChartData = {
      labels  : ['น้ำมันกัญชา (ตำรับหมอเดชา) DTAM GANJA OIL DEJA FORMULA'],
      datasets: [
        {
          type                : 'bar',
          label               : 'Total Usage',
          yAxesID: 'B',
          backgroundColor     : '#03fcf4',
          fill                : false,
          data                : [30]
        }
      ]
    }//End Cannabis Usage Data

    document.getElementById('sortChart1_card').style.display = "none";
    document.getElementById('sortChart2_card').style.display = "none";
    document.getElementById('sortChart3_card').style.display = "none";
    document.getElementById('sortChart4_card').style.display = "none";
    document.getElementById('sortChart5_card').style.display = "none";
  }
  
  /////////////////////////////
  //End Check sortSelect//////
  ////////////////////////////

  var patientChartOptions = {
    maintainAspectRatio : false,
    responsive : true,
    legend: {
      display: true,
      labels: {
          fontColor: "#faf7f7",
        }
    },
    scales: {
      xAxes: [{
        gridLines : {
          display : true,
        },
        ticks: {
          fontColor: "#faf7f7",
        }
      }],
      yAxes: [{
        ticks: {
          fontColor: "#faf7f7",
        }
      }]
    },
    onClick: function(evt){
      window.location.href = ("./node_sell_details.html?sortselected=" + getReq);
    },
  }//End patient Chart options

  var sortChartOptions = {
    maintainAspectRatio : false,
    responsive : true,
    legend: {
      display: true,
      labels: {
          fontColor: "#faf7f7",
        }
    },
    scales: {
      xAxes: [{
        gridLines : {
          display : true,
        },
        ticks: {
          fontColor: "#faf7f7",
        }
      }],
      yAxes: [{
        id: 'A',
        position: 'left',
        gridLines : {
          display : false,
        },
        ticks: {
          min: 0,
          fontColor: "#faf7f7",
        }
      }]
    }
  }//End sortChart option

  ////////////////////////////////////////
  /// CREATE CHART FIRST TIME ////////////
  ////////////////////////////////////////
  
  // This will get the first returned node in the jQuery collection.
  var patientChartCanvas = $('#paChart').get(0).getContext('2d');
  var patientChart = new Chart(patientChartCanvas, { 
      type: 'horizontalBar', 
      data: patientChartData, 
      options: patientChartOptions
    }
  )
  
  var cannabisUsageChartCanvas = $('#cannabisUsageChart').get(0).getContext('2d');
  var cannabisUsageChart = new Chart(cannabisUsageChartCanvas, {
    type: 'bar',
    data: cannabisUsageChartData,
    options: patientChartOptions
  })

  //SortChart1-5
  var sortChart1Canvas = $('#sortChart1').get(0).getContext('2d');
  var sortChart1 = new Chart(sortChart1Canvas, {
    type: 'doughnut',
    data: sortChart1Data,
    options: {
      responsive: true,
      legend: {
        display: false,
        position: 'top',
        labels: {
          fontColor: "white",
        },
      },
      legendCallback: function(chart) {
        
        var text = [];
        text.push('<center>');
        for (var i = 0; i < chart.data.labels.length; i++) {
                 
          text.push('<span class="chart-legend-label-text">'+'<i class="fas fa-square" style="color:' + chart.data.datasets[1].backgroundColor[i] + '"></i> ' + chart.data.labels[i] + '</span> ');
          
        }
        text.push('</center>');
        return text.join("");
      },
      animation: {
        animateScale: true,
        animateRotate: true,
      },
      tooltips:{
        callbacks: {
          label: function(item, data){
            console.log(data, item);
            return data.datasets[item.datasetIndex].label[item.index] + ": "+ data.datasets[item.datasetIndex].data[item.index] + " Unit";
          }
        }
      }
    }
  });
  $("#sortChart1_legend").html(sortChart1.generateLegend());
  console.log(document.getElementById('sortChart1_legend'));

  var sortChart2Canvas = $('#sortChart2').get(0).getContext('2d');
  var sortChart2 = new Chart(sortChart2Canvas, {
    type: 'bar',
    data: sortChart2Data,
    options: sortChartOptions,
  });

  var sortChart3Canvas = $('#sortChart3').get(0).getContext('2d');
  var sortChart3 = new Chart(sortChart3Canvas, {
    type: 'bar',
    data: sortChart3Data,
    options: sortChartOptions,
  });

  var sortChart4Canvas = $('#sortChart4').get(0).getContext('2d');
  var sortChart4 = new Chart(sortChart4Canvas, {
    type: 'bar',
    data: sortChart4Data,
    options: sortChartOptions,
  });

  var sortChart5Canvas = $('#sortChart5').get(0).getContext('2d');
  var sortChart5 = new Chart(sortChart5Canvas, {
    type: 'bar',
    data: sortChart5Data,
    options: sortChartOptions,
  });

  //การจ่ายยาให้ผู้ป่วยแบ่งตามเพศ Chart
  var medDistributeCanvas = $('#medDistribute').get(0).getContext('2d');

  var medDistributeData = {
    labels: [2015, 2016, 2017, 2018, 2019, 2020],
    datasets: [
      {
        label: 'Men patients',
        backgroundColor: '#33ccff',
        borderColor: '#33ccff',
        data: [2000, 10000, 1500, 1200, 3000, 600, 8000, 3500, 1600]
      },
      {
        label: 'Female patients',
        backgroundColor: '#ff80aa',
        borderColor    : '#ff80aa',
        data           : [700, 1700, 2700, 2000, 1800, 1500, 2000]
      }
    ]
  }
  var ticksStyle = {
      fontColor: '#faf7f7',
      fontStyle: 'bold'
    };

  var mode      = 'index';
  var intersect = true;
  var medDistributeChart = new Chart(medDistributeCanvas, {
    type: 'bar',
    data: medDistributeData,
    options: {
      maintainAspectRatio: false,
      responsive: true,
      legend: {
        display: true,
        labels: {
          fontColor: "#faf7f7",
        }
      },
      tooltips  : {
        mode      : mode,
        intersect : intersect,
        callbacks: {
          label: function(tooltipItem, Data){
            var label = Data.datasets[tooltipItem.datasetIndex].label || '';
            if (label){
              label += ': ';
            }
            label += Math.round(Data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index] * 100) / 100;
            label += ' ราย';
            return label;
          }
        }
      },
      hover     :{
        mode      : mode,
        intersect : intersect
      },
      scales:{
        yAxes: [{
          gridLines:{
            display: true,
            lineWidth: '4px',
            color: 'rgba(0, 0, 0, .2',
            zeroLineColor: 'transparent'
          },
          ticks    : $.extend({
              beginAtZero: true,

              // Include a dollar sign in the ticks
              callback: function (value, index, values) {
                if (value >= 1000) {
                  value /= 1000
                  value += 'k'
                }
                return value + 'ราย'
              }
            }, ticksStyle)
        }],
        xAxes: [{
          display  : true,
            gridLines: {
              display: false
            },
            ticks    : ticksStyle
        }]
      }
    }
  })

  //-------------
  //- DONUT CHART -
  //-------------
  // Get context with jQuery - using jQuery's .get() method.
  var donutChartCanvas = $('#donutChart').get(0).getContext('2d')
    var donutData        = {
      labels: [
          'ผู้ป่วยมะเร็ง', 
          'ภาวะกล้ามเนื้อหดเกร็ง',
          'ภาวะคลื่นไส้อาเจียน', 
          'ภาวะปวดประสาท', 
          'โรคพาร์กินสัน', 
          'อื่นๆ', 
      ],
      datasets: [
        {
          data: [700,500,400,600,300,100],
          backgroundColor : ['#f56954', '#00a65a', '#f39c12', '#00c0ef', '#3c8dbc', '#d2d6de'],
          
        }
      ]
    }
    var donutOptions     = {
      legend: {
        display: true,
        position: 'right',
        labels: {
          fontColor: "#faf7f7",
        }
      },
      tooltips: {
        callbacks: {
          label: function(tooltipItem, Data){
            var label = Data.labels[tooltipItem.index] || '';
            if (label){
              label += ': ';
            }
            label += Math.round(Data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index] * 100) / 100;
            label += ' ราย';
            return label;
          }
        }
      }
    }
    //Create pie or douhnut chart
    // You can switch between pie and douhnut using the method below.
    var donutChart = new Chart(donutChartCanvas, {
      type: 'doughnut',
      data: donutData,
      options: donutOptions      
    })

  //-----------------
  //- END DONUT CHART -
  //-----------------

  var barChartCanvas = $('#barChart').get(0).getContext('2d')
  var barChartData = {
  labels  : ['0 - 10', '10 - 20', '20 - 30', '30 - 40', '40 - 50', '50 - 60', '60 - 70', '70 - 80', '80 - 90', '90 - 100'],
  datasets: [
    {
      label: 'จำนวนผู้ป่วย',
      backgroundColor: '#1a53ff',
      borderColor: '#1a53ff',
      barPercentage: 0.5,
      data                : [0, 4, 19, 69, 156, 288, 292, 130, 32, 4]
    },
  ]
  }
    var barChartOptions = {
      legend: {
        display: false
      },
      responsive              : true,
      maintainAspectRatio     : false,
      datasetFill             : true,
      scales: {
        yAxes: [{
          ticks:{
            fontColor: "#faf7f7",
          }
        }],
        xAxes: [{
          ticks:{
            fontColor: "#faf7f7",
          }
        }]
      },
      tooltips: {
        callbacks: {
          label: function(tooltipItem, barChartData){
            var label = barChartData.datasets[tooltipItem.datasetIndex].label || '';
            if (label){
              label += ': ';
            }
            label += Math.round(tooltipItem.yLabel * 100) / 100;
            label += ' ราย';
            return label;
          }
        }
      }
    }

    var barChart = new Chart(barChartCanvas, {
      type: 'bar', 
      data: barChartData,
      options: barChartOptions
    })
    
  //set default value for paChart tools
  var paChart_month_sel = "02";
  var paChart_year_sel = "2563"
  var pc_month_txt = "กุมภาพันธ์";

  $('#paChart_button').on('click',function(){
    window.location.href = ("./node_sell_details.html?sortselected=" + getReq);
  });

  $('#paChart_month_sel a').click(function(){
    paChart_month_sel = $(this).attr("value");
    pc_month_txt = $(this).text();
    document.getElementById("paChart_header").innerText = pc_month_txt + '-' + paChart_year_sel;
    paChart_data_update();
  });

  $('#paChart_year_sel a').click(function(){
    paChart_year_sel = $(this).text();
    document.getElementById("paChart_header").innerText = pc_month_txt + '-' + paChart_year_sel;
    paChart_data_update();
  });

  //set default value for sortChart1 tools
  var sortChart1_type_sel = "01";
  var sortChart1_month_val = "02";
  var sortChart1_year_val = "2563";
  var sc1_type_sel = "GPO THC";
  var sc1_month_txt = "กุมภาพันธ์";
  var sc1_year_txt = "2563";
  
  $('#sortChart1_type_sel a').click(function(){
    sortChart1_type_sel = $(this).attr("value");
    sc1_type_sel = $(this).text();
    document.getElementById("sortChart1_title").innerText = sc1_type_sel + " Usage";
    if(sortChart1_type_sel == "01"){
      sortChart1Data.datasets[0].data = [62,43,11,18,0,1,1,0,1];
      sortChart1.update();
    }//GPO THC
    if(sortChart1_type_sel == "02"){
      sortChart1Data.datasets[0].data = [0,0,2,1,6,0,14,1,0];
      sortChart1.update();
    }//LOVE HEMP
    if(sortChart1_type_sel == "03"){
      sortChart1Data.datasets[0].data = [1,1,1,0,0,2,1,0,0];
      sortChart1.update();
    }//GPO THC:CBD (1:1) Usage
    if(sortChart1_type_sel == "04"){
      sortChart1Data.datasets[0].data = [43,3,5,12,1,0,0,0,0];
      sortChart1.update();
    }//น้ำมันกัญชาหยอดใต้ลิ้น
    if(sortChart1_type_sel == "05"){
      sortChart1Data.datasets[0].data = [1,0,0,1,0,0,0,0];
      sortChart1.update();
    }//น้ำมันกัญชาหยอดใต้ลิ้นสูตร THC 1.7%
  });

  $('#sortChart1_month_sel a').click(function(){
    sortChart1_month_val = $(this).attr("value");
    sc1_month_txt = $(this).text();
    document.getElementById("sortChart1_header").innerText = sc1_month_txt + " - " + sc1_year_txt;
    if(sortChart1_month_val == "02" & sortChart1_year_val=="2563"){
      sortChart1Data.datasets[0].data = [43,3,5,12,1,0,0,0,0];
      console.log(sortChart1Data.datasets[0].data);
      sortChart1.update();
    }
  });

  $('#sortChart1_year_sel a').click(function(){
    sortChart1_year_val = $(this).attr("value");
    sc1_year_txt = $(this).text();
    document.getElementById("sortChart1_header").innerText = sc1_month_txt + " - " + sc1_year_txt;

  });
  //End sortChart1 javascript function

  //sortChart5 initial
  var sortChart5_type_sel = "01";
  
  $('#sortChart5_type_sel a').click(function(){
    sortChart5_type_sel = $(this).attr("value");
    document.getElementById("sortChart5_title").innerText = $(this).text() + " Usage";

    if(sortChart5_type_sel == "01"){
      sortChart5Data.labels = ['นอนไม่หลับ','เบื่ออาหาร','ลมปลายปัตฆาตแขน','G AND MAINTAINING SLEEP [INSOMNIAS]','ลมปลายปัตฆาตสัญญาณ 1 หลัง'];
      sortChart5Data.datasets[0].data = [73,37,2,1,1];
      sortChart5.update();
    }//ยาศุขไสยาศน์ อาจาโร เฮิร์บ
    if(sortChart5_type_sel == "02"){
      sortChart5Data.labels = ['นอนไม่หลับ', 'PAKINSON\'S DISEASE','BREAST, UNSPECIFIED', 'BRONCHUS OR LUNG, UNSPECIFIED','MIGRAINE, UNSPECIFIED','COLON, UNSPECIFIED','สันนิบาตลูกนก','LIVER, UNSPECIFIED','NONORGANIC INSOMNIA','EPILEPSY, UNSPECIFIED'];
      sortChart5Data.datasets[0].data = [96,33,29,20,16,15,14,10,9,9];
      sortChart5.update();
    }//น้ำมันกัญชา (ตำรับหมอเดชา)
    if(sortChart5_type_sel == "03"){
      sortChart5Data.labels = ['นอนไม่หลับ','เบื่ออาหาร','ลมปลายปัตฆาตแขน','G AND MAINTAINING SLEEP [INSOMNIAS]','ลมปลายปัตฆาตสัญญาณ 1 หลัง'];
      sortChart5Data.datasets[0].data = [9,2,2,1,1,1];
      sortChart5.update();
    }//ยาทำลายพระสุเมรุ อาจาโร เฮิร์บ
    if(sortChart5_type_sel == "04"){
      sortChart5Data.labels = ['[INSOMNIAS]'];
      sortChart5Data.datasets[0].data = [2];
      sortChart5.update();
    }//ตำรับยาศุขไสยาศน์
  
  });

  //End sortChart5 javascript function
    
  //Get Param from url function
  function getUrlParameter(sParam){
    var sPageURL = window.location.search.substring(1);
    var sURLVariables = sPageURL.split('&');
    var sParameterName;
    for(var i=0; i< sURLVariables.length; i++){
      sParameterName = sURLVariables[i].split('=');
      if(sParameterName[0] === sParam){
        return sParameterName[1] === undefined? true : decodeURIComponent(sParameterName[1]);
      }
    }
  }
</script>
</body>
</html>
